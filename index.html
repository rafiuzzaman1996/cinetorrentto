<!DOCTYPE html>
<html lang="en" class="dark"> <!-- Default to dark theme -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineTorrentto</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&family=Roboto+Slab:wght@400;700&family=Roboto:wght@400;500;700&family=Audiowide&display=swap" rel="stylesheet">
    <link href="https://fonts.maateen.me/durbin/font.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="flex flex-col min-h-screen">
    <div id="ad-popunder"></div>
    
    <!-- Main App Section -->
    <div id="main-app" class="hidden w-full h-full flex flex-col flex-grow">
        <!-- Header -->
        <header class="main-header backdrop-blur-sm sticky top-0 z-40 shadow-lg shadow-black/20">
            <div class="w-full mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-20">
                    <div class="flex items-center gap-2">
                        <button id="back-btn" class="p-2 rounded-md focus:outline-none hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                            </svg>
                        </button>
                        <button id="filter-toggle-btn" class="p-2 rounded-md focus:outline-none">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707L16 11.414V16a1 1 0 01-.293.707l-2 2A1 1 0 0113 18v-6.586l-3.707-3.707A1 1 0 019 7V4a1 1 0 01-1-1H4a1 1 0 01-1-1z" />
                            </svg>
                        </button>
                        <span id="header-title" class="site-title text-3xl" style="color: #e8a265;">CineTorrentto</span>
                        <nav id="main-nav" class="hidden lg:flex items-center gap-2">
                            <!-- Navigation links will be populated by JS -->
                        </nav>
                    </div>
                    
                    <div id="main-search-wrapper" class="hidden md:flex flex-1 justify-center px-4">
                        <div class="w-full max-w-md">
                            <div class="relative">
                                <input id="search-bar" type="text" placeholder="Search movies or years..." class="form-input w-full rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <svg class="h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-4">
                        <button id="mobile-search-icon-btn" class="p-2 rounded-md focus:outline-none hidden">
                             <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                        </button>
                        <button id="switch-to-mobile-btn" class="p-2 rounded-full text-white bg-green-600 hover:bg-green-700 transition-colors" title="Mobile View">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                            </svg>
                        </button>
                        <div id="active-user-container" class="hidden items-center gap-2">
                           <div class="flex items-center gap-1 text-sm text-gray-400">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                <span id="current-users-count">0</span>
                                <span>Active</span>
                            </div>
                            <span id="active-user" class="text-sm font-semibold"></span>
                        </div>
                        <div class="hidden lg:flex items-center gap-2">
                             <button id="theme-toggle-btn" class="p-2 rounded-full text-gray-400 hover:bg-neutral-700">
                                <svg id="theme-icon-light" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                                <svg id="theme-icon-dark" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                             </button>
                             <button id="login-btn-header" class="px-4 py-2 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors font-semibold">Login</button>
                             <button id="admin-panel-btn" class="relative px-4 py-2 text-white bg-indigo-600 rounded-full hover:bg-indigo-700 transition-colors font-semibold hidden">
                                Admin Panel
                                <span id="admin-panel-notification-badge" class="absolute -top-1 -right-1 h-5 w-5 rounded-full bg-red-500 text-xs flex items-center justify-center hidden"></span>
                             </button>
                             <button id="request-movie-btn" class="px-4 py-2 text-white bg-sky-600 rounded-full hover:bg-sky-700 transition-colors font-semibold hidden">Request a Movie</button>
                             <button id="log-out" class="px-4 py-2 border rounded-full transition-colors hidden">Logout</button>
                        </div>
                        <div class="lg:hidden">
                            <button id="mobile-menu-btn" class="p-2 rounded-md focus:outline-none">
                                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                 <!-- Mobile Search Input -->
                <div id="mobile-search-container" class="hidden w-full pb-4">
                    <div class="relative">
                        <input id="mobile-search-input" type="text" placeholder="Search movies or years..." class="form-input w-full rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <svg class="h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Featured Section -->
        <section id="featured-section" class="relative w-full mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div id="featured-slider" class="flex overflow-x-auto snap-x snap-mandatory scroll-smooth -mx-2">
                <!-- Featured movies will be injected here -->
            </div>
            <button id="featured-prev" class="absolute top-1/2 left-0 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full z-10">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <button id="featured-next" class="absolute top-1/2 right-0 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full z-10">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </section>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden fixed inset-0 z-50 p-6 overflow-y-auto">
            <!-- Mobile menu content is now fully generated by main.js -->
        </div>
        
        <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden"></div>
        
        <div class="w-full flex flex-grow">
             <!-- Left Sidebar for Filters -->
            <aside id="left-sidebar" class="sidebar w-64 flex-shrink-0 p-4 space-y-4 hidden">
                <button id="clear-filters-btn" class="w-full px-4 py-2 text-white bg-red-600 rounded-full hover:bg-red-700 transition-colors font-semibold">Clear Filters</button>
                <details>
                    <summary class="text-sm font-bold p-2 rounded-md">Browse by Genre</summary>
                    <div id="genre-container" class="flex flex-col gap-1 mt-2 pl-2">
                        <!-- Genre buttons will be injected here -->
                    </div>
                </details>
                <details>
                    <summary class="text-sm font-bold p-2 rounded-md">Browse by Year</summary>
                    <div id="year-container" class="flex flex-col gap-1 mt-2 pl-2">
                        <!-- Year buttons will be injected here -->
                    </div>
                </details>
                <details>
                    <summary class="text-sm font-bold p-2 rounded-md">Browse Alphabetically</summary>
                    <div id="alphabet-container" class="grid grid-cols-4 gap-2 mt-2 pl-2">
                        <!-- Alphabet buttons will be injected here -->
                    </div>
                </details>
                <details open>
                    <summary class="text-sm font-bold p-2 rounded-md">Browse by Rating</summary>
                    <div id="rating-container" class="flex flex-col gap-1 mt-2 pl-2">
                        <!-- Rating buttons will be injected here -->
                    </div>
                </details>
                <details>
                    <summary class="text-sm font-bold p-2 rounded-md">Browse by Cast</summary>
                    <div id="cast-container" class="flex flex-col gap-1 mt-2 pl-2 max-h-60 overflow-y-auto">
                        <!-- Cast buttons will be injected here -->
                    </div>
                </details>
                <div id="ad-left-1" class="ad-placeholder mt-4" style="width: 160px; height: 300px;">Adsterra 160x300</div>
                <div id="ad-left-img-1" class="ad-placeholder mt-4" style="width: 180px; height: 320px;">Image Ad 180x320</div>
                <div id="ad-left-img-2" class="ad-placeholder mt-4" style="width: 180px; height: 320px;">Image Ad 180x320</div>
                <div id="ad-left-img-3" class="ad-placeholder mt-4" style="width: 180px; height: 320px;">Image Ad 180x320</div>
                <div id="ad-left-img-4" class="ad-placeholder mt-4" style="width: 180px; height: 320px;">Image Ad 180x320</div>
            </aside>

            <!-- Main Content -->
            <div class="flex-grow min-w-0 flex flex-col">
                <main id="main-content-area" class="p-4 sm:p-6 lg:p-8 flex-grow">
                     <div id="category-view" class="space-y-8">
                        <!-- Category sections will be injected here -->
                    </div>
                    <div id="filtered-view" class="hidden">
                        <div id="movies-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 gap-6">
                            <!-- Movie cards will be injected here -->
                        </div>
                        <div id="no-results" class="hidden flex-col items-center justify-center col-span-full h-60">
                            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-4"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="13" y1="8" x2="9" y2="12"></line><line x1="9" y1="8" x2="13" y2="12"></line></svg>
                            <h2 class="text-xl font-semibold">No content found.</h2>
                            <p>Try a different search term or category.</p>
                        </div>
                    </div>
                     <!-- Download Info Section -->
                    <section class="py-12 download-section text-center mt-8">
                        <div class="container mx-auto px-4">
                            <p class="text-base">Please let us know in the comments if you have any problems downloading. We will resolve the issue quickly.</p>
                            <p class="text-base text-gray-400 mb-6 bengali">(ডাউনলোড করতে সমস্যা হলে অবশ্যই কমেন্টে করে জানাবেন। আমরা সমস্যার দ্রুত সমাধান করব।)</p>
                            
                            <p class="text-base">To download, you must have one of the following 4 apps installed. If not, please install it using the links below.</p>
                            <p class="text-base text-gray-400 mb-10 bengali">(ডাউনলোড করার জন্য নিচের ৪টি অ্যাপ এর মধ্যে যেকোনো একটি ইন্সটল থাকতে হবে। না থাকলে অনুগ্রহ করে নিচের লিঙ্কগুলো থেকে ইন্সটল করে নিন।)</p>

                            <div class="grid md:grid-cols-2 gap-12">
                                <div>
                                    <h3 class="text-xl font-bold mb-4">Android User</h3>
                                    <div class="flex justify-center gap-4 flex-wrap">
                                        <a href="https://play.google.com/store/apps/details?id=org.freedownloadmanager.fdm&hl=en&referrer=utm_source%3Dgoogle%26utm_medium%3Dorganic%26utm_term%3Dfdm&pcampaignid=APPU_1_XB7LZ_HnK63H4-EP8PnbgQw" target="_blank" class="bg-black text-white px-8 py-3 rounded-full font-semibold hover:bg-neutral-700 transition-colors">FDM</a>
                                        <a href="https://play.google.com/store/apps/details?id=com.dv.adm&hl=en&referrer=utm_source%3Dgoogle%26utm_medium%3Dorganic%26utm_term%3Dadm&pcampaignid=APPU_1_IJLMZ9iVB-nG4-EPlr-RuQM" target="_blank" class="bg-black text-white px-8 py-3 rounded-full font-semibold hover:bg-neutral-700 transition-colors">ADM</a>
                                        <a href="https://play.google.com/store/apps/details?id=com.utorrent.client&hl=en&referrer=utm_source%3Dgoogle%26utm_medium%3Dorganic%26utm_term%3Dutorrent&pcampaignid=APPU_1_B5LMZ-W0IM6XjuMP1I3T0Q4" target="_blank" class="bg-black text-white px-8 py-3 rounded-full font-semibold hover:bg-neutral-700 transition-colors">µTorrent</a>
                                        <a href="https://play.google.com/store/apps/details?id=com.bittorrent.client&hl=en&referrer=utm_source%3Dgoogle%26utm_medium%3Dorganic%26utm_term%3Dbittorrent&pcampaignid=APPU_1_2pHMZ7LTG9Oq4-EP3qnzsQQ" target="_blank" class="bg-black text-white px-8 py-3 rounded-full font-semibold hover:bg-neutral-700 transition-colors">BitTorrent</a>
                                    </div>
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold mb-4">PC User</h3>
                                    <div class="flex justify-center gap-4 flex-wrap">
                                        <a href="https://files2.freedownloadmanager.org/6/latest/fdm_x64_setup.exe" target="_blank" class="bg-black text-white px-8 py-3 rounded-full font-semibold hover:bg-neutral-700 transition-colors">FDM</a>
                                        <a href="https://www.utorrent.com/web/downloads/complete/track/stable/os/win/" target="_blank" class="bg-black text-white px-8 py-3 rounded-full font-semibold hover:bg-neutral-700 transition-colors">µTorrent</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </main>
                <footer class="p-6 text-center">
                    <div id="ad-footer-728x90" class="ad-placeholder mx-auto mb-4" style="width: 728px; height: 90px; max-width: 100%;">Adsterra 728x90</div>
                    <h2 id="footer-title" class="site-title text-4xl mb-4 cursor-pointer" style="color: var(--brand-orange);">CineTorrentto</h2>
                    
                    <!-- Counters -->
                    <div class="my-6 flex flex-col md:flex-row items-center justify-center gap-x-6 gap-y-3 text-sm">
                        <div class="flex items-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a3.002 3.002 0 014.288 0M12 14a4 4 0 100-8 4 4 0 000 8z" />
                            </svg>
                            <p>
                                <span id="visitor-count-footer" class="font-bold">0</span> Visitors This Month
                            </p>
                        </div>
                        <div class="flex items-center gap-3">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197M15 21a6 6 0 006-6v-1a6 6 0 00-6-6h-1m-4 16a6 6 0 01-2-11.657" /></svg>
                             <p>
                                <span id="total-users-count-footer" class="font-bold">0</span> Total Users
                            </p>
                        </div>
                    </div>

                    <p class="text-xs text-gray-500">Copyright &copy; 2024 CineTorrentto. All Rights Reserved.</p>
                    <p class="text-xs text-gray-500 mt-2">Disclaimer: This site does not store any files on its server. All contents are provided by non-affiliated third parties.</p>
                </footer>
            </div>


            <!-- Right Sidebar for Ads & Socials -->
            <aside id="right-sidebar" class="w-48 flex-shrink-0 p-4 space-y-4 hidden xl:block">
                 <div id="right-sidebar-player" class="mb-4"></div>
                 <div id="ad-right-1" class="ad-placeholder mx-auto mb-4" style="width: 320px; height: 250px; max-width: 100%;">Adsterra 320x250</div>
                 <div id="ad-right-2" class="ad-placeholder mx-auto mb-4" style="width: 160px; height: 600px; max-width: 100%;">Adsterra 160x600</div>
                 <div id="ad-right-native" class="ad-placeholder mx-auto mb-4" style="width: 100%; height: auto; min-height: 100px;">Adsterra Native</div>
                 <div id="ad-right-img-1" class="ad-placeholder mx-auto mb-4" style="width: 180px; height: 320px; max-width: 100%;">Image Ad 180x320</div>
                 <div id="ad-right-img-2" class="ad-placeholder mx-auto mb-4" style="width: 180px; height: 320px; max-width: 100%;">Image Ad 180x320</div>
                 <div id="ad-right-img-3" class="ad-placeholder mx-auto mb-4" style="width: 180px; height: 320px; max-width: 100%;">Image Ad 180x320</div>
                 <div id="ad-right-468x60" class="ad-placeholder mx-auto mb-4" style="width: 468px; height: 60px; max-width: 100%;">Adsterra 468x60</div>
                 <div id="ad-right-320x50" class="ad-placeholder mx-auto mb-4" style="width: 320px; height: 50px; max-width: 100%;">Adsterra 320x50</div>
            </aside>
        </div>

        <button id="back-to-top" class="hidden fixed bottom-5 right-5 bg-red-600 text-white p-3 rounded-full shadow-lg z-50">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" /></svg>
        </button>
        
        <div id="floating-social-bar" class="fixed top-1/2 right-0 transform -translate-y-1/2 z-50 flex flex-col gap-2 p-2 bg-black bg-opacity-50 rounded-l-lg">
             <!-- Floating social icons will be injected here -->
        </div>
    </div>

    <!-- Login/Signup Modal -->
    <div id="login-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-md transform scale-95 transition-transform duration-300">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Login or Sign Up</h2>
                    <button type="button" id="login-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <!-- Login Form -->
                <div id="login-form-container">
                    <fieldset class="fieldset w-full pb-4 space-y-4">
                        <input id="name" type="text" class="form-input w-full p-3 rounded-md" placeholder="Username" required />
                        <div class="relative">
                            <input id="pass" type="password" class="form-input w-full p-3 rounded-md pr-10" placeholder="Password" required />
                            <button type="button" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-white" onclick="togglePasswordVisibility('pass')">
                                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2 2 0 012.828 2.828l1.515 1.515A4 4 0 0014 10a4 4 0 10-5.93 3.93l-1.515-1.515a2 2 0 01-2.828-2.828zM10 17a9.958 9.958 0 01-4.512-1.074l-1.78-1.781a1 1 0 01-1.414-1.414l14-14a1 1 0 011.414 1.414l-1.473 1.473A10.014 10.014 0 01.458 10C1.732 14.057 5.522 17 10 17z" clip-rule="evenodd" /></svg>
                            </button>
                        </div>
                        <p id="login-error" class="text-red-400 text-sm mt-2 hidden">Invalid username or password.</p>
                    </fieldset>
                    <button id="login-btn" class="w-full bg-red-600 text-white rounded-md px-4 py-3 font-semibold hover:bg-red-700 transition-colors duration-300">Login</button>
                     <div class="text-right mt-2">
                        <a href="#" id="forgot-password-link" class="text-sm text-red-400 hover:underline">Forgot Password?</a>
                    </div>
                    <p class="text-center mt-4 text-sm text-gray-400">
                        Don't have an account? <a href="#" id="show-signup" class="text-red-400 hover:underline">Sign Up</a>
                    </p>
                </div>

                <!-- Signup Form -->
                <div id="signup-form" class="hidden">
                    <h2 class="text-xl font-bold text-center mb-6 text-orange-300">Create Account</h2>
                    <fieldset class="fieldset w-full pb-4 space-y-4">
                        <input id="new-fullname" type="text" class="form-input w-full p-3 rounded-md" placeholder="Full Name" required />
                        <input id="new-name" type="text" class="form-input w-full p-3 rounded-md" placeholder="Choose Username" required />
                        <div class="relative">
                            <input id="new-pass" type="password" class="form-input w-full p-3 rounded-md pr-10" placeholder="Create Password" required />
                            <button type="button" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-white" onclick="togglePasswordVisibility('new-pass')">
                                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2 2 0 012.828 2.828l1.515 1.515A4 4 0 0014 10a4 4 0 10-5.93 3.93l-1.515-1.515a2 2 0 01-2.828-2.828zM10 17a9.958 9.958 0 01-4.512-1.074l-1.78-1.781a1 1 0 01-1.414-1.414l14-14a1 1 0 011.414 1.414l-1.473 1.473A10.014 10.014 0 01.458 10C1.732 14.057 5.522 17 10 17z" clip-rule="evenodd" /></svg>
                            </button>
                        </div>
                        <div class="relative">
                            <input id="confirm-pass" type="password" class="form-input w-full p-3 rounded-md pr-10" placeholder="Confirm Password" required />
                             <button type="button" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-white" onclick="togglePasswordVisibility('confirm-pass')">
                                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2 2 0 012.828 2.828l1.515 1.515A4 4 0 0014 10a4 4 0 10-5.93 3.93l-1.515-1.515a2 2 0 01-2.828-2.828zM10 17a9.958 9.958 0 01-4.512-1.074l-1.78-1.781a1 1 0 01-1.414-1.414l14-14a1 1 0 011.414 1.414l-1.473 1.473A10.014 10.014 0 01.458 10C1.732 14.057 5.522 17 10 17z" clip-rule="evenodd" /></svg>
                            </button>
                        </div>
                    </fieldset>
                    <button id="signup-btn" class="w-full bg-red-600 text-white rounded-md px-4 py-3 font-semibold hover:bg-red-700 transition-colors duration-300">Create Account</button>
                    <div class="mt-2 text-left">
                        <p id="signup-username-error" class="text-red-400 text-xs mt-1 hidden"></p>
                        <p id="signup-password-error" class="text-red-400 text-xs mt-1 hidden"></p>
                        <p id="signup-error" class="text-red-400 text-sm mt-2 hidden"></p>
                        <p id="signup-success-message" class="text-green-400 text-sm mt-2 hidden"></p>
                    </div>
                    <p class="text-center mt-4 text-sm text-gray-400">
                        Already have an account? <a href="#" id="show-login" class="text-red-400 hover:underline">Login</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Movie Details Modal -->
    <div id="movie-details-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div id="modal-content-wrapper" class="modal-content rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300">
            <!-- Modal content will be injected here -->
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="admin-panel-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-md transform scale-95 transition-transform duration-300">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Admin Panel</h2>
                    <button type="button" id="admin-panel-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <button id="modal-add-movie-btn" class="w-full p-4 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold">Add Content</button>
                    <button id="modal-edit-featured-btn" class="w-full p-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-semibold">Edit Featured</button>
                    <button id="modal-edit-socials-btn" class="w-full p-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold">Edit Socials</button>
                    <button id="modal-edit-ads-btn" class="w-full p-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold">Edit Ads</button>
                    <button id="modal-view-requests-btn" class="w-full p-4 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors font-semibold relative">
                        View Requests
                        <span id="modal-request-notification-badge" class="absolute -top-1 -right-1 h-5 w-5 rounded-full bg-red-500 text-xs flex items-center justify-center hidden"></span>
                    </button>
                    <button id="modal-manage-admins-btn" class="w-full p-4 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-semibold">Manage Admins</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Add Movie Form Modal -->
    <div id="add-movie-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-2xl transform scale-95 transition-transform duration-300">
            <form id="add-movie-form" class="p-8 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Add New Content</h2>
                    <button type="button" id="add-movie-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="space-y-4">
                    <input name="title" type="text" placeholder="Title" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                    <div class="grid grid-cols-3 gap-4">
                        <select name="release_day" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500"></select>
                        <select name="release_month" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500"></select>
                        <select name="release_year" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500"></select>
                    </div>
                    <input name="poster_path" type="text" placeholder="Poster Image URL" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500">
                    <input name="trailer_url" type="text" placeholder="Trailer URL (YouTube Embed Link)" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500">
                    <input name="stream_url" type="text" placeholder="Stream URL" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500">
                    <input name="vote_average" type="number" step="0.1" min="0" max="10" placeholder="Rating (0.0 - 10.0)" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                    <textarea name="overview" placeholder="Overview / Description" rows="3" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required></textarea>
                    
                    <input name="director" type="text" placeholder="Director(s)" class="form-input w-full p-3 rounded-md">
                    <input name="runningTime" type="text" placeholder="Running Time (e.g., 120 min)" class="form-input w-full p-3 rounded-md">
                    <input name="budget" type="text" placeholder="Budget (e.g., $100 million)" class="form-input w-full p-3 rounded-md">
                    <textarea name="cast" placeholder="Cast (comma separated)" rows="2" class="form-input w-full p-3 rounded-md"></textarea>

                    <div>
                        <label for="genre-select" class="block mb-2 text-sm font-medium text-left">Genre(s) (Hold Ctrl/Cmd to select multiple)</label>
                        <select name="genres" id="genre-select" multiple class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500 h-32">
                            <!-- Genre options will be populated by JS -->
                        </select>
                    </div>
                     <div>
                        <label for="category-select" class="block mb-2 text-sm font-medium text-left">Category</label>
                        <select name="category" id="category-select" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                            <!-- Category options will be populated by JS -->
                        </select>
                    </div>
                </div>
                
                <div class="border-t border-neutral-700 my-6"></div>

                <div>
                    <h3 class="text-lg font-semibold mb-3">Download Links</h3>
                    <div id="download-links-container" class="space-y-4">
                        <!-- Dynamic download link fields will be injected here -->
                    </div>
                    <button type="button" id="add-download-link-btn" class="mt-4 text-red-400 hover:text-red-300 font-semibold text-sm">+ Add Another Link</button>
                </div>

                <div class="mt-8 text-right">
                    <button type="submit" class="bg-red-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-red-700 transition-colors">Add Content</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Request Movie Form Modal -->
    <div id="request-movie-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-lg transform scale-95 transition-transform duration-300">
            <form id="request-movie-form" class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Request a Movie</h2>
                    <button type="button" id="request-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="space-y-4">
                    <input name="movieName" type="text" placeholder="Movie Name" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                    <input name="movieYear" type="number" placeholder="Year" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500">
                    <textarea name="movieDescription" placeholder="Description (optional)" rows="4" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500"></textarea>
                </div>
                <div class="mt-8 text-right">
                    <button type="submit" class="bg-sky-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-sky-700 transition-colors">Submit Request</button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Requests Modal (Admin only) -->
    <div id="view-requests-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
         <div class="modal-content rounded-lg shadow-2xl w-full max-w-2xl transform scale-95 transition-transform duration-300">
             <div class="p-8 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">User Movie Requests</h2>
                    <button type="button" id="view-requests-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div id="requests-list" class="space-y-4">
                    <!-- Requests will be populated here -->
                </div>
                <div class="mt-8 text-right">
                    <button id="clear-requests-btn" class="bg-red-700 text-white font-semibold px-6 py-3 rounded-lg hover:bg-red-800 transition-colors">Clear All Requests</button>
                </div>
             </div>
        </div>
    </div>

    <!-- Trailer Modal -->
    <div id="trailer-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-3xl transform scale-95 transition-transform duration-300">
            <div class="p-2 relative" style="padding-top: 56.25%;"> <!-- 16:9 Aspect Ratio -->
                <div id="trailer-content" class="absolute top-0 left-0 w-full h-full">
                    <!-- YouTube iframe will be injected here -->
                </div>
                 <button onclick="closeModal('trailer-modal')" class="absolute -top-2 -right-2 text-gray-400 hover:text-white transition-colors bg-black bg-opacity-50 rounded-full p-1">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Stream Modal -->
    <div id="stream-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-4xl transform scale-95 transition-transform duration-300">
            <div class="p-2 relative" style="padding-top: 56.25%;"> <!-- 16:9 Aspect Ratio -->
                <div id="stream-content" class="absolute top-0 left-0 w-full h-full">
                    <!-- Stream iframe will be injected here -->
                </div>
                 <button onclick="closeModal('stream-modal')" class="absolute -top-2 -right-2 text-gray-400 hover:text-white transition-colors bg-black bg-opacity-50 rounded-full p-1">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Socials Modal (Admin only) -->
    <div id="edit-socials-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-lg transform scale-95 transition-transform duration-300">
            <form id="edit-socials-form" class="p-8 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Edit Social Links</h2>
                    <button type="button" id="edit-socials-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div id="social-links-inputs-container" class="space-y-4">
                    <!-- Social link inputs will be populated by JS -->
                </div>
                <button type="button" id="add-social-link-btn" class="mt-4 text-red-400 hover:text-red-300 font-semibold text-sm">+ Add New Social Link</button>
                <div class="mt-8 text-right">
                    <button type="submit" class="bg-red-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-red-700 transition-colors">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Ads Modal (Admin only) -->
    <div id="edit-ads-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-4xl transform scale-95 transition-transform duration-300">
            <form id="edit-ads-form" class="p-8 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Edit Ad Codes</h2>
                    <button type="button" id="edit-ads-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Left Sidebar Ads -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold border-b border-neutral-600 pb-2">Left Sidebar</h3>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Adsterra Ad (160x300)</label>
                            <textarea name="adLeft1" rows="3" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" placeholder="Paste Adsterra code here..."></textarea>
                        </div>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Image Ad URLs (180x320)</label>
                            <input name="adLeftImg1" type="text" placeholder="Image URL 1" class="form-input w-full p-3 rounded-md mb-2">
                            <input name="adLeftImg2" type="text" placeholder="Image URL 2" class="form-input w-full p-3 rounded-md mb-2">
                            <input name="adLeftImg3" type="text" placeholder="Image URL 3" class="form-input w-full p-3 rounded-md mb-2">
                            <input name="adLeftImg4" type="text" placeholder="Image URL 4" class="form-input w-full p-3 rounded-md">
                        </div>
                    </div>
                    <!-- Right Sidebar Ads -->
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold border-b border-neutral-600 pb-2">Right Sidebar</h3>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Video Player URL (YouTube/GDrive)</label>
                            <input name="sidebarVideo" type="text" class="form-input w-full p-3 rounded-md">
                        </div>
                         <div>
                            <label class="block mb-2 text-sm font-medium text-left">Adsterra Ad (320x250)</label>
                            <textarea name="right1" rows="3" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra code here..."></textarea>
                        </div>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Adsterra Ad (160x600)</label>
                            <textarea name="right2" rows="3" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra code here..."></textarea>
                        </div>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Adsterra Native Banner</label>
                            <textarea name="rightNative" rows="3" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra code here..."></textarea>
                        </div>
                         <div>
                            <label class="block mb-2 text-sm font-medium text-left">Image Ad URLs (180x320)</label>
                            <input name="rightImg1" type="text" placeholder="Image URL 1" class="form-input w-full p-3 rounded-md mb-2">
                            <input name="rightImg2" type="text" placeholder="Image URL 2" class="form-input w-full p-3 rounded-md mb-2">
                            <input name="rightImg3" type="text" placeholder="Image URL 3" class="form-input w-full p-3 rounded-md">
                        </div>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Adsterra Ad (468x60)</label>
                            <textarea name="right468x60" rows="2" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra code here..."></textarea>
                        </div>
                        <div>
                            <label class="block mb-2 text-sm font-medium text-left">Adsterra Ad (320x50)</label>
                            <textarea name="right320x50" rows="2" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra code here..."></textarea>
                        </div>
                    </div>
                </div>
                 <div class="col-span-1 md:col-span-2 mt-6">
                     <h3 class="text-lg font-semibold border-b border-neutral-600 pb-2">Other Ads</h3>
                     <div>
                        <label class="block mb-2 text-sm font-medium text-left">Adsterra Social Bar</label>
                        <textarea name="adSocialBar" rows="3" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra Social Bar code here..."></textarea>
                    </div>
                     <div>
                        <label class="block mb-2 text-sm font-medium text-left mt-4">Adsterra Popunder</label>
                        <textarea name="adPopunder" rows="3" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra Popunder code here..."></textarea>
                    </div>
                     <div>
                        <label class="block mb-2 text-sm font-medium text-left mt-4">Footer Ad (728x90)</label>
                        <textarea name="adFooter728x90" rows="3" class="form-input w-full p-3 rounded-md" placeholder="Paste Adsterra code here..."></textarea>
                    </div>
                </div>
                <div class="mt-8 text-right">
                    <button type="submit" class="bg-red-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-red-700 transition-colors">Save Ad Codes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Password Reset Modal -->
    <div id="password-reset-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-md transform scale-95 transition-transform duration-300">
            <form id="password-reset-form" class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Reset Password</h2>
                    <button type="button" id="password-reset-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div id="reset-step-1" class="space-y-4">
                    <p class="text-sm text-gray-400">Enter your Full Name and Username to verify your account.</p>
                    <input name="resetFullName" type="text" placeholder="Your Full Name" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                    <input name="resetUsername" type="text" placeholder="Your Username" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                    <p id="reset-error" class="text-red-400 text-sm mt-2 hidden"></p>
                    <button type="button" id="verify-user-btn" class="w-full bg-red-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-red-700 transition-colors">Verify</button>
                </div>
                <div id="reset-step-2" class="hidden space-y-4">
                    <p class="text-sm text-gray-400">Verification successful. Enter your new password.</p>
                    <div class="relative">
                        <input name="newPassword" id="newPassword" type="password" placeholder="New Password" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500 pr-10" required>
                        <button type="button" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-white" onclick="togglePasswordVisibility('newPassword')">
                           <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2 2 0 012.828 2.828l1.515 1.515A4 4 0 0014 10a4 4 0 10-5.93 3.93l-1.515-1.515a2 2 0 01-2.828-2.828zM10 17a9.958 9.958 0 01-4.512-1.074l-1.78-1.781a1 1 0 01-1.414-1.414l14-14a1 1 0 011.414 1.414l-1.473 1.473A10.014 10.014 0 01.458 10C1.732 14.057 5.522 17 10 17z" clip-rule="evenodd" /></svg>
                        </button>
                    </div>
                    <div class="relative">
                        <input name="confirmNewPassword" id="confirmNewPassword" type="password" placeholder="Confirm New Password" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500 pr-10" required>
                         <button type="button" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-white" onclick="togglePasswordVisibility('confirmNewPassword')">
                           <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2 2 0 012.828 2.828l1.515 1.515A4 4 0 0014 10a4 4 0 10-5.93 3.93l-1.515-1.515a2 2 0 01-2.828-2.828zM10 17a9.958 9.958 0 01-4.512-1.074l-1.78-1.781a1 1 0 01-1.414-1.414l14-14a1 1 0 011.414 1.414l-1.473 1.473A10.014 10.014 0 01.458 10C1.732 14.057 5.522 17 10 17z" clip-rule="evenodd" /></svg>
                        </button>
                    </div>
                    <p id="reset-password-error" class="text-red-400 text-sm mt-2 hidden"></p>
                    <button type="submit" class="w-full bg-red-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-red-700 transition-colors">Reset Password</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Edit Featured Modal -->
    <div id="edit-featured-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-2xl transform scale-95 transition-transform duration-300">
            <div class="p-8 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Edit Featured Content</h2>
                    <button type="button" id="edit-featured-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                
                <div class="mb-4">
                    <input id="featured-search-bar" type="text" placeholder="Search for content to add..." class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500">
                    <div id="featured-search-results" class="mt-2 max-h-48 overflow-y-auto"></div>
                </div>

                <h3 class="text-lg font-semibold mb-3">Current Featured Items</h3>
                <div id="current-featured-list" class="space-y-2">
                    <!-- Current featured items will be listed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Manage Admins Modal -->
    <div id="manage-admins-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-lg transform scale-95 transition-transform duration-300">
            <div class="p-8 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Manage Admins</h2>
                    <button type="button" id="manage-admins-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3">Current Admins</h3>
                    <div id="admin-list" class="space-y-2">
                        <!-- Admin list will be populated here -->
                    </div>
                </div>

                <div>
                    <h3 class="text-lg font-semibold mb-3">Add New Admin</h3>
                    <form id="add-admin-form" class="flex gap-2">
                        <input name="username" type="text" placeholder="Enter username to promote" class="form-input w-full p-3 rounded-md focus:ring-red-500 focus:border-red-500" required>
                        <button type="submit" class="bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">Add</button>
                    </form>
                    <p id="add-admin-error" class="text-red-400 text-sm mt-2 hidden"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="notification-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-sm transform scale-95 transition-transform duration-300">
            <div class="p-8 text-center">
                <p id="notification-message" class="mb-6"></p>
                <button id="notification-close-btn" class="bg-red-600 text-white font-semibold px-6 py-2 rounded-lg hover:bg-red-700 transition-colors">OK</button>
            </div>
        </div>
    </div>

        <!-- About Us Modal -->
    <div id="about-us-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop hidden">
        <div class="modal-content rounded-lg shadow-2xl w-full max-w-lg transform scale-95 transition-transform duration-300">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">About CineTorrentto</h2>
                    <button type="button" id="about-us-modal-close-btn" class="text-gray-400 hover:text-white transition-colors">
                        <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="space-y-4 text-sm text-gray-300">
                    <p>Welcome to CineTorrentto, your ultimate destination for a vast collection of movies, TV series, games, and more. Our mission is to provide a user-friendly platform where entertainment enthusiasts can discover, access, and enjoy a wide range of digital content.</p>
                    <p>We are dedicated to constantly updating our library with the latest releases and timeless classics. Whether you're looking for a blockbuster movie, a binge-worthy TV show, or the latest game, CineTorrentto has you covered.</p>
                    <p>Please note that this site does not store any files on its server. All contents are provided by non-affiliated third parties. We encourage our users to support the creators by purchasing their content through official channels.</p>
                    <p>Thank you for being a part of our community!</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 
  CineTorrentto - Mobile Version
  Instructions: Paste this entire block of code at the very end of your existing index.html file, just before the closing </body> tag.
  This code is self-contained and will not interfere with your existing desktop site.
-->

<!-- ======================================================================= -->
<!-- ======================= MOBILE VIEW STYLES (CSS) ====================== -->
<!-- ======================================================================= -->
<style>
    /* Hides the mobile view by default */
    #mobile-view-container {
        display: none;
    }

    /* When mobile view is active, hide the desktop view and show mobile */
    body.mobile-active #main-app {
        display: none;
    }

    body.mobile-active #mobile-view-container {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }
    
    /* Remove scrollbar for a cleaner mobile look */
    .mobile-no-scrollbar::-webkit-scrollbar {
        display: none; /* Safari and Chrome */
    }
    .mobile-no-scrollbar {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }

    /* Side Navigation Menu Styling */
    #mobile-side-nav {
        transition: transform 0.3s ease-in-out;
    }

    #mobile-side-nav.open {
        transform: translateX(0);
    }

    /* Filter Menu Styling */
    #mobile-filter-menu {
        transition: transform 0.3s ease-in-out;
        background-color: rgba(38, 38, 38, 0.8); /* 80% transparent dark background */
        backdrop-filter: blur(10px);
    }
    
    #mobile-filter-menu.open {
        transform: translateX(0);
    }
    
    /* Custom styles for filter dropdowns */
    .mobile-filter-select {
        background-color: #404040;
        border: 1px solid #525252;
        color: #f9fafb;
    }

    /* Movie Details Modal Styling */
    #mobile-movie-details-modal .modal-content {
        max-width: 90vw; /* Use viewport width for better responsiveness */
        width: 100%;
        max-height: 85vh;
    }
    
    @media (min-width: 640px) {
        #mobile-movie-details-modal .modal-content {
            max-width: 50vw; /* Roughly 50% smaller on larger mobile screens */
        }
    }
    
    /* Ensure video player appears on top */
    #trailer-modal, #stream-modal {
        z-index: 60 !important;
    }

    /* Custom aspect ratio for mobile posters */
    .mobile-poster-wrapper {
        position: relative;
        padding-top: 150%; /* 2:3 aspect ratio */
        background-color: #262626;
        border-radius: 0.5rem;
        overflow: hidden;
    }
    .mobile-poster-wrapper img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* Details modal poster wrapper (2:3) */
    .modal-poster-wrapper {
        position: relative;
        padding-top: 150%; /* 2:3 Aspect Ratio */
        background-color: #262626;
        border-radius: 0.375rem; /* rounded-md */
        overflow: hidden;
    }
    .modal-poster-wrapper img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* Hover effects for menu items */
    .mobile-nav-item:hover {
        background-color: #404040;
        color: #e8a265;
    }

    /* Colored labels in details modal */
    .details-label {
        color: #e8a265;
    }

    /* Floating Social Bar */
    #mobile-floating-social-bar {
        position: fixed;
        top: 50%;
        right: 0;
        transform: translateY(-50%);
        z-index: 45; /* Below modals but above content */
    }
</style>


<!-- ======================================================================= -->
<!-- ======================== MOBILE VIEW MARKUP (HTML) ==================== -->
<!-- ======================================================================= -->
<div id="mobile-view-container" class="bg-neutral-900 text-white font-sans w-full h-full">
    <!-- Header -->
    <header class="bg-neutral-800/80 backdrop-blur-sm sticky top-0 z-40 px-4 py-3 flex items-center justify-between shadow-lg">
        <button id="mobile-nav-toggle-btn" class="p-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
        </button>
        <h1 id="mobile-header-title" class="text-xl font-bold site-title cursor-pointer" style="color: #e8a265;">CineTorrentto</h1>
        <button id="mobile-filter-toggle-btn" class="p-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" /></svg>
        </button>
    </header>

    <!-- Main Content -->
    <main id="mobile-main-content" class="flex-grow p-2 mobile-no-scrollbar">
        <div class="w-full max-w-md mx-auto my-2">
            <div class="relative">
                <input id="mobile-search-bar" type="text" placeholder="Search movies or years..." class="form-input w-full rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all bg-neutral-700 border-neutral-600">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                </div>
            </div>
        </div>
        
        <!-- Homepage View -->
        <div id="mobile-homepage-view">
            <!-- Featured Section -->
            <section id="mobile-featured-section" class="mb-6">
                <h2 class="text-xl font-bold mb-3 text-amber-400">Featured</h2>
                <div id="mobile-featured-grid" class="grid grid-cols-3 sm:grid-cols-4 gap-2">
                    <!-- Featured movies will be injected here -->
                </div>
            </section>
            
            <!-- Category Sections -->
            <div id="mobile-category-view" class="space-y-6">
                <!-- Category sections will be injected here -->
            </div>
        </div>

        <!-- Filtered View -->
        <div id="mobile-filtered-view" class="hidden">
            <div id="mobile-movies-grid" class="grid grid-cols-3 sm:grid-cols-4 gap-2">
                <!-- Mobile movie cards will be injected here -->
            </div>
            <div id="mobile-no-results" class="hidden flex-col items-center justify-center text-center h-60">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-4 text-neutral-500"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line><line x1="13" y1="8" x2="9" y2="12"></line><line x1="9" y1="8" x2="13" y2="12"></line></svg>
                <h2 class="text-lg font-semibold">No Content Found</h2>
                <p class="text-neutral-400 text-sm">Try adjusting your filters.</p>
            </div>
        </div>

        <!-- Download Info Section -->
        <section class="py-8 text-center mt-6 text-xs">
            <div class="container mx-auto px-2">
                <p>Please let us know in the comments if you have any problems downloading. We will resolve the issue quickly.</p>
                <p class="text-gray-400 mb-4 bengali">(ডাউনলোড করতে সমস্যা হলে অবশ্যই কমেন্টে করে জানাবেন। আমরা সমস্যার দ্রুত সমাধান করব।)</p>
                
                <p>To download, you must have one of the following 4 apps installed. If not, please install it using the links below.</p>
                <p class="text-gray-400 mb-6 bengali">(ডাউনলোড করার জন্য নিচের ৪টি অ্যাপ এর মধ্যে যেকোনো একটি ইন্সটল থাকতে হবে। না থাকলে অনুগ্রহ করে নিচের লিঙ্কগুলো থেকে ইন্সটল করে নিন।)</p>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-bold mb-2">Android User</h3>
                        <div class="flex justify-center gap-2 flex-wrap">
                            <a href="https://play.google.com/store/apps/details?id=org.freedownloadmanager.fdm" target="_blank" class="bg-black text-white px-4 py-1.5 rounded-full font-semibold hover:bg-neutral-700 transition-colors text-xs">FDM</a>
                            <a href="https://play.google.com/store/apps/details?id=com.dv.adm" target="_blank" class="bg-black text-white px-4 py-1.5 rounded-full font-semibold hover:bg-neutral-700 transition-colors text-xs">ADM</a>
                            <a href="https://play.google.com/store/apps/details?id=com.utorrent.client" target="_blank" class="bg-black text-white px-4 py-1.5 rounded-full font-semibold hover:bg-neutral-700 transition-colors text-xs">µTorrent</a>
                            <a href="https://play.google.com/store/apps/details?id=com.bittorrent.client" target="_blank" class="bg-black text-white px-4 py-1.5 rounded-full font-semibold hover:bg-neutral-700 transition-colors text-xs">BitTorrent</a>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-bold mb-2">PC User</h3>
                        <div class="flex justify-center gap-2 flex-wrap">
                            <a href="https://files2.freedownloadmanager.org/6/latest/fdm_x64_setup.exe" target="_blank" class="bg-black text-white px-4 py-1.5 rounded-full font-semibold hover:bg-neutral-700 transition-colors text-xs">FDM</a>
                            <a href="https://www.utorrent.com/web/downloads/complete/track/stable/os/win/" target="_blank" class="bg-black text-white px-4 py-1.5 rounded-full font-semibold hover:bg-neutral-700 transition-colors text-xs">µTorrent</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="p-4 text-center text-white bg-neutral-800/80">
        <div id="mobile-ad-footer-728x90" class="ad-placeholder mx-auto mb-4" style="width: 100%; max-width: 728px; height: 90px;"></div>
        <div class="my-4 flex flex-col md:flex-row items-center justify-center gap-x-6 gap-y-2 text-xs">
            <div class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283-.356-1.857m0 0a3.002 3.002 0 014.288 0M12 14a4 4 0 100-8 4 4 0 000 8z" /></svg>
                <p><span id="mobile-visitor-count-footer" class="font-bold">0</span> Visitors</p>
            </div>
            <div class="flex items-center gap-2">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197M15 21a6 6 0 006-6v-1a6 6 0 00-6-6h-1m-4 16a6 6 0 01-2-11.657" /></svg>
                 <p><span id="mobile-total-users-count-footer" class="font-bold">0</span> Total Users</p>
            </div>
        </div>
        <p class="text-xs text-gray-500">Copyright &copy; 2024 CineTorrentto.</p>
    </footer>

    <!-- Side Navigation Menu -->
    <div id="mobile-nav-overlay" class="fixed inset-0 bg-black/60 z-40 hidden"></div>
    <nav id="mobile-side-nav" class="fixed top-0 left-0 w-56 h-full bg-neutral-800 z-50 transform -translate-x-full p-4 mobile-no-scrollbar overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold site-title" style="color: #e8a265;">Menu</h2>
            <div>
                <button id="switch-to-desktop-btn-icon" class="p-1 mobile-nav-item rounded-md">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                </button>
                <button id="mobile-nav-close-btn" class="p-1 text-2xl">&times;</button>
            </div>
        </div>
        <!-- User actions and categories will be injected here by JS -->
        <div id="mobile-user-actions"></div>
        <hr class="border-neutral-700 my-3">
        <div id="mobile-category-links"></div>
        <hr class="border-neutral-700 my-3">
        <div id="mobile-nav-ad-container" class="space-y-2 my-3"></div>
    </nav>

    <!-- Filter Menu -->
    <div id="mobile-filter-overlay" class="fixed inset-0 bg-black/60 z-40 hidden"></div>
    <div id="mobile-filter-menu" class="fixed top-0 right-0 w-60 h-full z-50 transform translate-x-full p-4 mobile-no-scrollbar overflow-y-auto">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold site-title" style="color: #e8a265;">Filters</h2>
            <button id="mobile-filter-close-btn" class="p-2 text-white text-3xl">&times;</button>
        </div>
        <div id="mobile-filter-actions" class="mb-4"></div>
        <div class="space-y-4">
            <div>
                <label for="mobile-genre-filter" class="block mb-1 text-sm font-medium text-neutral-300">Genre</label>
                <select id="mobile-genre-filter" class="mobile-filter-select w-full p-2 rounded-md">
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <div>
                <label for="mobile-year-filter" class="block mb-1 text-sm font-medium text-neutral-300">Year</label>
                <select id="mobile-year-filter" class="mobile-filter-select w-full p-2 rounded-md">
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <div>
                <label for="mobile-cast-filter" class="block mb-1 text-sm font-medium text-neutral-300">Cast</label>
                <select id="mobile-cast-filter" class="mobile-filter-select w-full p-2 rounded-md">
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <div>
                <label for="mobile-alphabet-filter" class="block mb-1 text-sm font-medium text-neutral-300">Alphabetical</label>
                <select id="mobile-alphabet-filter" class="mobile-filter-select w-full p-2 rounded-md">
                    <!-- Options will be populated by JS -->
                </select>
            </div>
        </div>
        <div class="mt-6">
            <button id="mobile-clear-filters-btn" class="w-full px-4 py-2 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors font-semibold">Clear Filters</button>
        </div>
        <hr class="border-neutral-700 my-4">
        <div id="mobile-filter-ad-container" class="space-y-2"></div>
    </div>
    
    <!-- Mobile Movie Details Modal -->
    <div id="mobile-movie-details-modal" class="fixed inset-0 z-50 flex items-center justify-center p-2 modal-backdrop hidden">
        <div class="modal-content bg-neutral-800 rounded-lg shadow-2xl w-full mobile-no-scrollbar overflow-y-auto">
            <!-- Mobile modal content will be injected here -->
        </div>
    </div>
    
    <!-- Floating Social Bar -->
    <div id="mobile-floating-social-bar" class="flex flex-col gap-2 p-2 bg-black bg-opacity-50 rounded-l-lg">
        <!-- Floating social icons will be injected here -->
    </div>
    
    <!-- Back to Top Button -->
    <button id="mobile-back-to-top" class="hidden fixed bottom-5 right-5 bg-red-600 text-white p-3 rounded-full shadow-lg z-50">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" /></svg>
    </button>

</div>


<!-- ======================================================================= -->
<!-- ===================== MOBILE VIEW LOGIC (JavaScript) ================== -->
<!-- ======================================================================= -->
<script>
(function() {
    // This IIFE (Immediately Invoked Function Expression) creates a private scope
    // to prevent conflicts with the existing desktop JavaScript code.

    // --- DOM ELEMENT SELECTORS ---
    const mobileView = document.getElementById('mobile-view-container');
    const switchToMobileBtn = document.getElementById('switch-to-mobile-btn');

    const mobileNavToggleBtn = document.getElementById('mobile-nav-toggle-btn');
    const mobileNavCloseBtn = document.getElementById('mobile-nav-close-btn');
    const mobileSideNav = document.getElementById('mobile-side-nav');
    const mobileNavOverlay = document.getElementById('mobile-nav-overlay');

    const mobileFilterToggleBtn = document.getElementById('mobile-filter-toggle-btn');
    const mobileFilterCloseBtn = document.getElementById('mobile-filter-close-btn');
    const mobileFilterMenu = document.getElementById('mobile-filter-menu');
    const mobileFilterOverlay = document.getElementById('mobile-filter-overlay');
    
    const mobileHomepageView = document.getElementById('mobile-homepage-view');
    const mobileFilteredView = document.getElementById('mobile-filtered-view');
    const mobileCategoryView = document.getElementById('mobile-category-view');
    const mobileMoviesGrid = document.getElementById('mobile-movies-grid');
    const mobileNoResults = document.getElementById('mobile-no-results');
    const mobileSearchBar = document.getElementById('mobile-search-bar');
    
    const mobileGenreFilter = document.getElementById('mobile-genre-filter');
    const mobileYearFilter = document.getElementById('mobile-year-filter');
    const mobileCastFilter = document.getElementById('mobile-cast-filter');
    const mobileAlphabetFilter = document.getElementById('mobile-alphabet-filter');
    const mobileClearFiltersBtn = document.getElementById('mobile-clear-filters-btn');
    
    const mobileDetailsModal = document.getElementById('mobile-movie-details-modal');
    const mobileHeaderTitle = document.getElementById('mobile-header-title');
    const mobileBackToTopBtn = document.getElementById('mobile-back-to-top');
    const mobileMainContent = document.getElementById('mobile-main-content');

    // --- STATE MANAGEMENT ---
    let allMoviesCache = [];

    // --- CORE FUNCTIONS ---

    /**
     * The core initialization logic for the mobile view.
     */
    function runMobileInitialization() {
        // Use the globally available mockApiData from main.js
        allMoviesCache = Object.values(mockApiData.movies).flat();
        allMoviesCache = Array.from(new Map(allMoviesCache.map(m => [m.id, m])).values());
        
        bindEventListeners();
        populateFilters();
        populateSideNav();
        populateMobileAds();
        updateMobileFooterCounters();
        displayMobileHomepage();
        displayMobileSocialIcons('mobile-floating-social-bar');
    }

    /**
     * Initializes the mobile view logic. It waits for the desktop script to load its 
     * data (`mockApiData`) before running the actual initialization.
     */
    function initializeMobileView() {
        // By the time the 'load' event fires, all scripts including main.js should have executed.
        if (typeof mockApiData !== 'undefined' && typeof mockApiData.movies !== 'undefined' && Object.keys(mockApiData.movies).length > 0) {
            runMobileInitialization();
        } else {
            console.error("Mobile View Error: 'mockApiData' was not available even after the page loaded. Check if main.js and database.js are loading correctly before this script.");
        }
    }

    /**
     * Binds all necessary event listeners for the mobile view.
     */
    function bindEventListeners() {
        switchToMobileBtn.addEventListener('click', showMobileView);
        mobileHeaderTitle.addEventListener('click', displayMobileHomepage);

        mobileNavToggleBtn.addEventListener('click', openSideNav);
        mobileNavCloseBtn.addEventListener('click', closeSideNav);
        mobileNavOverlay.addEventListener('click', closeSideNav);

        mobileFilterToggleBtn.addEventListener('click', openFilterMenu);
        mobileFilterCloseBtn.addEventListener('click', closeFilterMenu);
        mobileFilterOverlay.addEventListener('click', closeFilterMenu);

        mobileSearchBar.addEventListener('input', applyMobileFilters);
        mobileGenreFilter.addEventListener('change', applyMobileFilters);
        mobileYearFilter.addEventListener('change', applyMobileFilters);
        mobileCastFilter.addEventListener('change', applyMobileFilters);
        mobileAlphabetFilter.addEventListener('change', applyMobileFilters);
        mobileClearFiltersBtn.addEventListener('click', clearAllFilters);
        
        mobileDetailsModal.addEventListener('click', (e) => {
            if (e.target === mobileDetailsModal) {
                closeModal('mobile-movie-details-modal');
            }
        });

        mobileMainContent.addEventListener('scroll', () => {
            if (mobileMainContent.scrollTop > 300) {
                mobileBackToTopBtn.classList.remove('hidden');
            } else {
                mobileBackToTopBtn.classList.add('hidden');
            }
        });

        mobileBackToTopBtn.addEventListener('click', () => {
            mobileMainContent.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        document.getElementById('switch-to-desktop-btn-icon').addEventListener('click', showDesktopView);
    }

    // --- VIEW SWITCHING LOGIC ---

    function showMobileView() {
        document.body.classList.add('mobile-active');
    }

    function showDesktopView() {
        document.body.classList.remove('mobile-active');
    }

    // --- UI POPULATION ---

    function populateFilters() {
        const genres = Object.values(mockApiData.genres).sort();
        mobileGenreFilter.innerHTML = '<option value="">All Genres</option>' + genres.map(g => `<option value="${g}">${g}</option>`).join('');
        const years = [...new Set(allMoviesCache.map(m => m.release_year))].sort((a, b) => b - a);
        mobileYearFilter.innerHTML = '<option value="">All Years</option>' + years.map(y => `<option value="${y}">${y}</option>`).join('');
        const cast = [...new Set(allMoviesCache.flatMap(m => m.cast ? m.cast.split(',').map(c => c.trim()) : []))].sort();
        mobileCastFilter.innerHTML = '<option value="">All Cast</option>' + cast.map(c => `<option value="${c}">${c}</option>`).join('');
        const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        mobileAlphabetFilter.innerHTML = '<option value="">Alphabetical</option>' + alphabet.map(l => `<option value="${l}">${l}</option>`).join('');
    }
    
    function populateSideNav() {
        const userActionsContainer = document.getElementById('mobile-user-actions');
        const categoryLinksContainer = document.getElementById('mobile-category-links');
        const aboutUsBtnHTML = `<button id="mobile-about-us-btn" class="mobile-nav-item w-full text-left p-2 rounded-md flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <span>About Us</span>
        </button>`;
        const currentUser = localStorage.getItem('currentUser');

        let userActionsHtml = '';
        if (currentUser) {
            const activeUsers = document.getElementById('current-users-count')?.textContent || '0';
            userActionsHtml += `
                <div class="p-2">
                    <div class="flex items-center gap-1 text-sm text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                        <span>${activeUsers}</span>
                        <span>Active</span>
                    </div>
                    <p class="text-md mt-1"><span class="details-label">Welcome,</span> ${currentUser}</p>
                </div>
                <div class="mobile-nav-item w-full p-2 rounded-md flex items-center justify-between">
                    <button id="mobile-logout-btn" class="flex-grow text-left">Logout</button>
                    <button id="mobile-theme-btn" class="p-1">
                       <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                    </button>
                </div>
            `;
        } else {
            userActionsHtml += `
                <div class="mobile-nav-item w-full p-2 rounded-md flex items-center justify-between">
                    <button id="mobile-login-btn" class="flex-grow text-left">Login / Sign Up</button>
                    <button id="mobile-theme-btn" class="p-1">
                        <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                    </button>
                </div>
            `;
        }
        
        userActionsContainer.innerHTML = userActionsHtml;

        const categories = mockApiData.categories || {};
        const tutorialsKey = 'tutorials';
        let categoryHtml = '';
        for (const key in categories) {
            categoryHtml += `<a href="#" class="mobile-nav-item block p-2 rounded-md mobile-category-link" data-category="${key}">${categories[key]}</a>`;
            if (key === tutorialsKey) {
                categoryHtml += aboutUsBtnHTML;
            }
        }
        categoryLinksContainer.innerHTML = categoryHtml;
        
        // Re-bind events for newly created elements
        if (document.getElementById('mobile-logout-btn')) {
            document.getElementById('mobile-logout-btn').addEventListener('click', () => {
                document.getElementById('log-out').click();
                populateSideNav();
            });
        }
        if (document.getElementById('mobile-login-btn')) {
            document.getElementById('mobile-login-btn').addEventListener('click', () => {
                document.getElementById('login-btn-header').click();
                closeSideNav();
            });
        }
        document.getElementById('mobile-theme-btn').addEventListener('click', () => {
            document.getElementById('theme-toggle-btn').click();
        });
        document.getElementById('mobile-about-us-btn').addEventListener('click', () => {
            document.getElementById('footer-title').click();
            closeSideNav();
        });
        
        document.querySelectorAll('.mobile-category-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const categoryKey = e.target.dataset.category;
                showFullCategory(categoryKey);
                closeSideNav();
            });
        });
    }

    function populateMobileAds() {
        const adCodes = mockApiData.ads || {};
        const navAdContainer = document.getElementById('mobile-nav-ad-container');
        const filterAdContainer = document.getElementById('mobile-filter-ad-container');
        const footerAdContainer = document.getElementById('mobile-ad-footer-728x90');

        const getAdHtml = (content, defaultText) => {
            if (content && (content.startsWith('http') || content.startsWith('https:')) && /\.(jpe?g|png|gif|webp)$/i.test(content)) {
                return `<img src="${content}" alt="Ad" class="w-full h-auto object-contain">`;
            } else if (content) {
                return content;
            }
            return `<div class="ad-placeholder w-full text-center p-2 text-xs">${defaultText}</div>`;
        };

        if (navAdContainer) {
            navAdContainer.innerHTML = `
                ${getAdHtml(adCodes.adLeft1, 'Ad 160x300')}
                ${getAdHtml(adCodes.adLeftImg1, 'Image Ad')}
            `;
        }
        
        if (filterAdContainer) {
            filterAdContainer.innerHTML = `
                ${getAdHtml(adCodes.right1, 'Ad 320x250')}
                ${getAdHtml(adCodes.right2, 'Adsterra 160x600')}
                ${getAdHtml(adCodes.right468x60, 'Adsterra 468x60')}
                ${getAdHtml(adCodes.right320x50, 'Adsterra 320x50')}
                ${getAdHtml(adCodes.rightNative, 'Native Ad')}
                ${getAdHtml(adCodes.rightImg1, 'Image Ad 1')}
                ${getAdHtml(adCodes.rightImg2, 'Image Ad 2')}
                ${getAdHtml(adCodes.rightImg3, 'Image Ad 3')}
            `;
        }
        
        if(footerAdContainer) {
            footerAdContainer.innerHTML = getAdHtml(adCodes.adFooter728x90, 'Adsterra 728x90');
        }
    }
    
    function populateFilterMenuActions() {
        const container = document.getElementById('mobile-filter-actions');
        const currentUser = localStorage.getItem('currentUser');
        const isAdmin = admins.includes(currentUser);
        
        if (isAdmin) {
            container.innerHTML = `<button id="mobile-admin-panel-btn" class="w-full p-2 mb-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors font-semibold">Admin Panel</button>`;
            document.getElementById('mobile-admin-panel-btn').addEventListener('click', () => {
                document.getElementById('admin-panel-btn').click();
                closeFilterMenu();
            });
        } else if (currentUser) {
            container.innerHTML = `<button id="mobile-request-movie-btn" class="w-full p-2 mb-2 bg-sky-600 text-white rounded-md hover:bg-sky-700 transition-colors font-semibold">Request a Movie</button>`;
            document.getElementById('mobile-request-movie-btn').addEventListener('click', () => {
                document.getElementById('request-movie-btn').click();
                closeFilterMenu();
            });
        } else {
            container.innerHTML = '';
        }
    }

    function updateMobileFooterCounters() {
        const visitorCountSpan = document.getElementById('mobile-visitor-count-footer');
        const totalUsersSpan = document.getElementById('mobile-total-users-count-footer');
        if (visitorCountSpan) {
            visitorCountSpan.textContent = document.getElementById('visitor-count-footer')?.textContent || '0';
        }
        if (totalUsersSpan) {
            totalUsersSpan.textContent = document.getElementById('total-users-count-footer')?.textContent || '0';
        }
    }
    
    function displayMobileSocialIcons(containerId) {
        const container = document.getElementById(containerId);
        if (!container) return;
        const links = mockApiData.socialLinks || {};
        container.innerHTML = Object.entries(links).map(([name, url]) => {
            if (!url) return '';
            const iconUrl = `https://www.google.com/s2/favicons?sz=64&domain_url=${url}`;
            return `
                <a href="${url}" target="_blank" class="text-white hover:opacity-75 transition-opacity" title="${name}">
                    <img src="${iconUrl}" alt="${name}" class="w-6 h-6 rounded-full" onerror="this.style.display='none'">
                </a>
            `;
        }).join('');
    }

    function createMobileMovieCard(movie) {
        let posterUrl = 'https://placehold.co/300x450/1f2937/374151?text=No+Image';
        if (movie.poster_path) {
            if (movie.poster_path.includes('drive.google.com')) {
                const fileIdMatch = movie.poster_path.match(/d\/(.+?)\//);
                if (fileIdMatch && fileIdMatch[1]) {
                    posterUrl = `https://lh3.googleusercontent.com/d/${fileIdMatch[1]}=w300`;
                }
            } else {
                posterUrl = `https://image.tmdb.org/t/p/w300${movie.poster_path}`;
            }
        }

        return `
            <div class="movie-card-mobile rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-1 transition-all duration-300 cursor-pointer bg-neutral-800" onclick="showMobileMovieDetails(${movie.id})">
                <div class="mobile-poster-wrapper">
                    <img loading="lazy" src="${posterUrl}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/300x450/1f2937/374151?text=No+Image';">
                </div>
                <div class="p-1.5">
                    <h3 class="font-bold text-xs truncate text-white">${movie.title}</h3>
                    <div class="flex justify-between items-center mt-1 text-xs text-neutral-400">
                        <span>${movie.release_year}</span>
                        <span class="text-amber-400 font-semibold">★ ${movie.vote_average?.toFixed(1) || 'N/A'}</span>
                    </div>
                </div>
            </div>
        `;
    }
    
    function displayMobileHomepage() {
        mobileFilteredView.classList.add('hidden');
        mobileHomepageView.classList.remove('hidden');
        
        displayMobileFeaturedMovies();
        
        mobileCategoryView.innerHTML = '';
        const categoriesToDisplay = Object.keys(mockApiData.categories);

        categoriesToDisplay.forEach(catKey => {
            const movies = mockApiData.movies[catKey] || [];
            if (movies.length > 0) {
                const sortedMovies = [...movies].sort((a, b) => new Date(b.release_date) - new Date(a.release_date));
                const topMovies = sortedMovies.slice(0, 6);

                const section = document.createElement('section');
                section.innerHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-xl font-bold">${mockApiData.categories[catKey]}</h2>
                        <button class="see-more-link bg-red-600 text-white rounded-md px-3 py-1 text-xs font-semibold hover:bg-red-700 transition-colors" data-category="${catKey}">SEE ALL</button>
                    </div>
                    <div class="grid grid-cols-3 sm:grid-cols-4 gap-2">
                        ${topMovies.map(createMobileMovieCard).join('')}
                    </div>
                `;
                mobileCategoryView.appendChild(section);
            }
        });

        document.querySelectorAll('.see-more-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const categoryKey = e.target.dataset.category;
                showFullCategory(categoryKey);
            });
        });
    }

    function displayMobileFeaturedMovies() {
        const featuredGrid = document.getElementById('mobile-featured-grid');
        const featuredIds = mockApiData.featuredIds || [];
        const featuredMovies = featuredIds.map(id => findMovieById(id)).filter(Boolean);
        
        featuredGrid.innerHTML = featuredMovies.map(createMobileMovieCard).join('');
    }

    function showFullCategory(categoryKey) {
        mobileHomepageView.classList.add('hidden');
        mobileFilteredView.classList.remove('hidden');
        renderMobileMovies(mockApiData.movies[categoryKey] || []);
    }
    
    function renderMobileMovies(movies) {
        if (!movies || movies.length === 0) {
            mobileMoviesGrid.innerHTML = '';
            mobileNoResults.classList.remove('hidden');
        } else {
            mobileNoResults.classList.add('hidden');
            const sortedMovies = [...movies].sort((a, b) => new Date(b.release_date) - new Date(a.release_date));
            mobileMoviesGrid.innerHTML = sortedMovies.map(createMobileMovieCard).join('');
        }
    }

    // --- FILTERING LOGIC ---

    function applyMobileFilters() {
        mobileHomepageView.classList.add('hidden');
        mobileFilteredView.classList.remove('hidden');

        let filteredMovies = [...allMoviesCache];
        const searchTerm = mobileSearchBar.value.toLowerCase().trim();
        const genre = mobileGenreFilter.value;
        const year = mobileYearFilter.value;
        const cast = mobileCastFilter.value;
        const letter = mobileAlphabetFilter.value;

        if (searchTerm) {
            filteredMovies = filteredMovies.filter(movie =>
                movie.title.toLowerCase().includes(searchTerm) ||
                movie.release_year.toString().includes(searchTerm)
            );
        }
        if (genre) {
            filteredMovies = filteredMovies.filter(movie => movie.genres && movie.genres.includes(genre));
        }
        if (year) {
            filteredMovies = filteredMovies.filter(movie => movie.release_year == year);
        }
        if (cast) {
            filteredMovies = filteredMovies.filter(movie => movie.cast && movie.cast.includes(cast));
        }
        if (letter) {
            filteredMovies = filteredMovies.filter(movie => movie.title.toLowerCase().startsWith(letter.toLowerCase()));
        }

        renderMobileMovies(filteredMovies);
    }

    function clearAllFilters() {
        mobileSearchBar.value = '';
        mobileGenreFilter.value = '';
        mobileYearFilter.value = '';
        mobileCastFilter.value = '';
        mobileAlphabetFilter.value = '';
        displayMobileHomepage();
    }

    // --- MODAL AND MENU LOGIC ---
    
    function openSideNav() {
        populateSideNav(); // Refresh user info every time it opens
        mobileSideNav.classList.add('open');
        mobileNavOverlay.classList.remove('hidden');
    }

    function closeSideNav() {
        mobileSideNav.classList.remove('open');
        mobileNavOverlay.classList.add('hidden');
    }

    function openFilterMenu() {
        populateFilterMenuActions();
        mobileFilterMenu.classList.add('open');
        mobileFilterOverlay.classList.remove('hidden');
    }

    function closeFilterMenu() {
        mobileFilterMenu.classList.remove('open');
        mobileFilterOverlay.classList.add('hidden');
    }
    
    window.showMobileMovieDetails = function(movieId) {
        const movie = findMovieById(movieId);
        if (!movie) return;

        const modalContent = mobileDetailsModal.querySelector('.modal-content');
        
        let posterUrl = 'https://placehold.co/300x450/1f2937/374151?text=No+Image';
        if (movie.poster_path) {
            if (movie.poster_path.includes('drive.google.com')) {
                const fileIdMatch = movie.poster_path.match(/d\/(.+?)\//);
                 if (fileIdMatch && fileIdMatch[1]) {
                    posterUrl = `https://lh3.googleusercontent.com/d/${fileIdMatch[1]}=w300`;
                }
            } else {
                posterUrl = `https://image.tmdb.org/t/p/w300${movie.poster_path}`;
            }
        }
        const comments = movie.comments || [];
        const releaseDate = movie.release_date ? new Date(movie.release_date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : movie.release_year;

        const modalHtml = `
            <div class="p-4 relative">
                <button onclick="closeModal('mobile-movie-details-modal')" class="absolute top-2 right-2 p-1 text-3xl text-white z-10">&times;</button>
                
                <div class="flex flex-row gap-4 items-start mb-4">
                    <div class="w-24 flex-shrink-0">
                         <div class="modal-poster-wrapper">
                            <img src="${posterUrl}" alt="${movie.title}" onerror="this.onerror=null;this.src='https://placehold.co/300x450/1f2937/374151?text=No+Image';">
                         </div>
                    </div>
                    <div class="flex-grow min-w-0">
                        <h2 class="text-xl font-bold text-white leading-tight">${movie.title} <span class="font-normal text-neutral-400">(${movie.release_year})</span></h2>
                        <div class="flex flex-wrap gap-1 mt-1">
                            ${movie.genres ? movie.genres.map(genre => `<span class="bg-neutral-700 text-neutral-300 text-xs font-semibold px-2 py-0.5 rounded-full">${genre}</span>`).join('') : ''}
                        </div>
                        <p class="text-sm mt-2"><strong>Rating:</strong> <span class="font-bold text-amber-400">★ ${movie.vote_average.toFixed(1)}</span></p>
                    </div>
                </div>

                <h3 class="text-md font-semibold mt-4 mb-1 text-white">Overview</h3>
                <p class="text-sm text-neutral-300 leading-relaxed mb-4">${movie.overview}</p>
                
                <div class="text-sm space-y-1 text-neutral-400 mb-4">
                     <p><strong class="details-label">Release Date:</strong> ${releaseDate || 'N/A'}</p>
                     <p><strong class="details-label">Director:</strong> ${movie.director || 'N/A'}</p>
                     <p><strong class="details-label">Running Time:</strong> ${movie.runningTime || 'N/A'}</p>
                     <p><strong class="details-label">Budget:</strong> ${movie.budget || 'N/A'}</p>
                     <p><strong class="details-label">Cast:</strong> ${movie.cast || 'N/A'}</p>
                </div>

                <div class="mt-4 flex gap-2">
                    ${movie.stream_url ? `<button onclick="playStream('${movie.stream_url}')" class="flex-1 bg-green-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-green-700">Stream</button>` : ''}
                    ${movie.trailer_url ? `<button onclick="playTrailer('${movie.trailer_url}')" class="flex-1 bg-white/10 text-white font-semibold px-4 py-2 rounded-lg hover:bg-white/20">Trailer</button>` : ''}
                </div>

                <div class="mt-6">
                    <h3 class="text-lg font-semibold mb-2 text-white">Download Options</h3>
                    <div class="grid grid-cols-2 gap-2">
                        ${(movie.download_links || []).map(link => `
                            <button onclick="openDownloadLinks(event, ${movie.id}, '${link.name}', '${link.url || '#'}')" class="bg-red-600 text-white font-semibold px-3 py-2 rounded-lg hover:bg-red-700 text-sm truncate">
                                ${link.name} ${link.size ? `(${link.size})` : ''}
                            </button>
                        `).join('')}
                    </div>
                </div>

                <div class="mt-6">
                    <h3 class="text-lg font-semibold mb-3 details-label">Share this Movie</h3>
                    <div class="flex gap-2" id="mobile-share-buttons"></div>
                </div>

                <div class="mt-6">
                    <h3 class="text-xl font-bold mb-4 details-label">Comments</h3>
                    <div id="mobile-comment-list" class="space-y-4 max-h-40 overflow-y-auto pr-2 mb-4">
                        ${comments.length > 0 ? comments.map((comment) => `
                            <div class="p-3 rounded-lg bg-neutral-700">
                                <p class="font-semibold text-sm">${comment.username}</p>
                                <p class="text-xs text-gray-400">${comment.date}</p>
                                <p class="mt-2 text-sm">${comment.text}</p>
                            </div>
                        `).join('') : '<p class="text-gray-400 text-sm">No comments yet.</p>'}
                    </div>
                    <form id="mobile-comment-form" data-movie-id="${movie.id}">
                        <textarea name="comment" placeholder="Write a comment..." class="form-input w-full p-2 rounded-md bg-neutral-700 border-neutral-600" rows="2" required></textarea>
                        <button type="submit" class="w-full mt-2 bg-red-600 text-white font-semibold py-2 rounded-lg hover:bg-red-700">Post Comment</button>
                    </form>
                </div>
            </div>
        `;
        
        modalContent.innerHTML = modalHtml;

        // Dynamically add share buttons and comment form listener
        const shareButtonsContainer = modalContent.querySelector('#mobile-share-buttons');
        if(shareButtonsContainer) {
            shareButtonsContainer.innerHTML = `
                <button onclick="shareMovie('facebook', '${movie.title}', ${movie.id})" class="bg-blue-600 text-white p-2 rounded-full"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.14 9.5 5.32v2.14H6v4h3.5v10h4V11.46h3.77l.72-4z"/></svg></button>
                <button onclick="shareMovie('twitter', '${movie.title}', ${movie.id})" class="bg-black text-white p-2 rounded-full"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 16 16"><path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.602.75Zm-2.25 13.05h1.694L5.405 2.165H3.555z"/></svg></button>
                <button onclick="shareMovie('whatsapp', '${movie.title}', ${movie.id})" class="bg-green-500 text-white p-2 rounded-full"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M16.75 13.96c.25.5.12 1.04-.12 1.41a1.98 1.98 0 0 1-1.52.85c-.34 0-.68-.06-1.02-.18c-1.44-.55-2.83-1.48-4-2.65c-1.17-1.17-2.1-2.56-2.65-4c-.12-.34-.18-.68-.18-1.02c0-.58.29-1.12.85-1.52c.37-.24.91-.37 1.41-.12c.5.25.83.71.96 1.25c.13.54.06 1.11-.2 1.61l-.48.96c-.13.25-.06.56.18.8l1.79 1.79c.24.24.55.31.8.18l.96-.48c.5-.26 1.07-.33 1.61-.2c.54.13 1 .46 1.25.96zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c1.85 0 3.59-.55 5.07-1.49L22 22l-1.49-4.93A9.95 9.95 0 0 0 22 12C22 6.48 17.52 2 12 2z"/></svg></button>
            `;
        }
        modalContent.querySelector('#mobile-comment-form').addEventListener('submit', (event) => {
            event.preventDefault();
            const form = event.target;
            const movieId = parseInt(form.dataset.movieId);
            const commentText = form.querySelector('textarea[name="comment"]').value.trim();
            if (!commentText) return;
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                showNotification('You must be logged in to comment.');
                return;
            }
            const newComment = { username: currentUser, text: commentText, date: new Date().toLocaleString() };
            for (const category in mockApiData.movies) {
                const movie = mockApiData.movies[category].find(m => m.id === movieId);
                if (movie) {
                    if (!movie.comments) movie.comments = [];
                    movie.comments.push(newComment);
                    break;
                }
            }
            localStorage.setItem('movieDatabase', JSON.stringify(mockApiData));
            showMobileMovieDetails(movieId); // Refresh the modal
        });

        mobileDetailsModal.classList.remove('hidden');
        setTimeout(() => modalContent.classList.remove('scale-95'), 10);
    }

    // --- INITIALIZATION ---
    // Use window.onload to ensure all scripts, including main.js, are fully loaded.
    window.addEventListener('load', function() {
        initializeMobileView();
    });

})();
</script>

 
    
    <div id="ad-social-bar"></div>

    <script src="database.js"></script>
    <script src="main.js"></script>
</body>
</html>
